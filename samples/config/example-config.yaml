# GuardDuty to Sentinel Integration Configuration
# This file demonstrates YAML configuration format

# Core processing settings
batchSize: 200
maxRetries: 3
retryBackoffMs: 1500
enableNormalization: false
deadLetterQueue: "guardduty-dlq"

# Azure Monitor ingestion endpoint
azureEndpoint: "https://your-dcr-endpoint.azure.com"

# Data Collection Rule configuration
dcr:
  immutableId: "dcr-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  streamName: "Custom-GuardDutyFindings"
  # endpoint is optional for new DCRs with built-in endpoints
  # endpoint: "https://your-custom-dcr-endpoint.azure.com"

# AWS configuration
aws:
  region: "eu-west-1"
  s3BucketName: "your-guardduty-export-bucket"
  s3BucketPrefix: "guardduty-exports/"
  kmsKeyArn: "arn:aws:kms:eu-west-1:123456789012:key/your-kms-key-id"
  # Optional: Explicit AWS credentials (prefer IAM roles when possible)
  # accessKeyId: "your-access-key-id"
  # secretAccessKey: "your-secret-access-key"

# Azure configuration
azure:
  tenantId: "your-azure-tenant-id"
  clientId: "your-service-principal-client-id"
  clientSecret: "your-service-principal-client-secret"
  workspaceId: "your-log-analytics-workspace-id"
  subscriptionId: "your-azure-subscription-id"
  resourceGroupName: "your-resource-group-name"

# Deduplication settings
deduplication:
  enabled: true
  strategy: "timeWindow"  # Options: findingId, contentHash, timeWindow
  timeWindowMinutes: 60
  cacheSize: 15000

# Monitoring and observability
monitoring:
  enableMetrics: true
  enableDetailedLogging: true
  healthCheckPort: 9090
  metricsBackend:
    type: "prometheus"
    config:
      endpoint: "http://prometheus:9090"
      pushGateway: "http://pushgateway:9091"