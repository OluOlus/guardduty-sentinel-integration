# GuardDuty to Sentinel Integration - Environment Variables
# Copy this file to .env and customize the values for your environment

# Core processing settings
BATCH_SIZE=100
MAX_RETRIES=3
RETRY_BACKOFF_MS=1000
ENABLE_NORMALIZATION=false
DEAD_LETTER_QUEUE=guardduty-failed-findings

# Azure Monitor ingestion endpoint
AZURE_ENDPOINT=https://your-dcr-endpoint.azure.com

# Data Collection Rule configuration
DCR_IMMUTABLE_ID=dcr-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
DCR_STREAM_NAME=Custom-GuardDutyFindings
# DCR_ENDPOINT=https://your-custom-dcr-endpoint.azure.com  # Optional for new DCRs

# AWS configuration
AWS_REGION=us-east-1
AWS_S3_BUCKET_NAME=your-guardduty-export-bucket
AWS_S3_BUCKET_PREFIX=guardduty-exports/
AWS_KMS_KEY_ARN=arn:aws:kms:us-east-1:123456789012:key/your-kms-key-id
# AWS_ACCESS_KEY_ID=your-access-key-id  # Optional, prefer IAM roles
# AWS_SECRET_ACCESS_KEY=your-secret-access-key  # Optional, prefer IAM roles
# AWS_SESSION_TOKEN=your-session-token  # Optional, for temporary credentials

# Azure configuration
AZURE_TENANT_ID=your-azure-tenant-id
AZURE_CLIENT_ID=your-service-principal-client-id
AZURE_CLIENT_SECRET=your-service-principal-client-secret
AZURE_WORKSPACE_ID=your-log-analytics-workspace-id
AZURE_SUBSCRIPTION_ID=your-azure-subscription-id
AZURE_RESOURCE_GROUP_NAME=your-resource-group-name

# Deduplication settings
DEDUPLICATION_ENABLED=true
DEDUPLICATION_STRATEGY=findingId  # Options: findingId, contentHash, timeWindow
# DEDUPLICATION_TIME_WINDOW_MINUTES=60  # Required for timeWindow strategy
DEDUPLICATION_CACHE_SIZE=10000

# Monitoring and observability
MONITORING_ENABLE_METRICS=true
MONITORING_ENABLE_DETAILED_LOGGING=false
MONITORING_HEALTH_CHECK_PORT=8080