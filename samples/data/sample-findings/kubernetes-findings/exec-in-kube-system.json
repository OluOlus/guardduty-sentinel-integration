{
  "schemaVersion": "2.0",
  "accountId": "777888999000",
  "region": "us-west-1",
  "partition": "aws",
  "id": "6e5f7g8h9i0j1k2l3m4n5o6p7q8r9s0t",
  "arn": "arn:aws:guardduty:us-west-1:777888999000:detector/66f001f987e6d5432109876543210/finding/6e5f7g8h9i0j1k2l3m4n5o6p7q8r9s0t",
  "type": "Execution:Kubernetes/ExecInKubeSystemPod",
  "resource": {
    "resourceType": "EKSCluster",
    "kubernetesDetails": {
      "kubernetesUserDetails": {
        "username": "system:serviceaccount:default:suspicious-sa",
        "uid": "12345678-abcd-1234-efgh-123456789012",
        "groups": [
          "system:serviceaccounts",
          "system:serviceaccounts:default",
          "system:authenticated"
        ]
      },
      "kubernetesWorkloadDetails": {
        "name": "coredns-558bd4d5db-xyz12",
        "type": "Pod",
        "uid": "87654321-dcba-4321-hgfe-210987654321",
        "namespace": "kube-system",
        "hostNetwork": false,
        "containers": [
          {
            "containerRuntime": "containerd",
            "id": "containerd://1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef",
            "name": "coredns",
            "image": "602401143452.dkr.ecr.us-west-1.amazonaws.com/eks/coredns:v1.8.7-eksbuild.3",
            "imagePrefix": "602401143452.dkr.ecr.us-west-1.amazonaws.com/eks/coredns",
            "volumeMounts": [
              {
                "name": "config-volume",
                "mountPath": "/etc/coredns"
              },
              {
                "name": "tmp",
                "mountPath": "/tmp"
              }
            ],
            "securityContext": {
              "privileged": false,
              "allowPrivilegeEscalation": false
            }
          }
        ],
        "volumes": [
          {
            "name": "config-volume",
            "hostPath": {
              "path": "/etc/coredns"
            }
          },
          {
            "name": "tmp",
            "hostPath": {
              "path": "/tmp"
            }
          }
        ]
      }
    }
  },
  "service": {
    "serviceName": "guardduty",
    "detectorId": "66f001f987e6d5432109876543210",
    "action": {
      "actionType": "KUBERNETES_API_CALL",
      "kubernetesApiCallAction": {
        "requestUri": "/api/v1/namespaces/kube-system/pods/coredns-558bd4d5db-xyz12/exec",
        "verb": "create",
        "sourceIps": [
          "10.0.1.100"
        ],
        "userAgent": "kubectl/v1.24.0 (linux/amd64) kubernetes/4ce5a89",
        "remoteIpDetails": {
          "ipAddressV4": "10.0.1.100",
          "organization": {
            "asn": "16509",
            "asnOrg": "Amazon.com, Inc.",
            "isp": "Amazon.com",
            "org": "Amazon Technologies Inc."
          },
          "country": {
            "countryCode": "US",
            "countryName": "United States"
          },
          "city": {
            "cityName": "Seattle"
          },
          "geoLocation": {
            "lat": 47.6062,
            "lon": -122.3321
          }
        },
        "statusCode": 101,
        "parameters": "command=%2Fbin%2Fsh&container=coredns&stdin=true&stdout=true&tty=true"
      }
    },
    "evidence": null,
    "archived": false,
    "count": 1,
    "eventFirstSeen": "2024-01-06T16:45:00.000Z",
    "eventLastSeen": "2024-01-06T16:45:00.000Z",
    "resourceRole": "TARGET",
    "additionalInfo": {
      "value": "{\"sample\": true, \"namespace\": \"kube-system\", \"podName\": \"coredns-558bd4d5db-xyz12\"}",
      "type": "default"
    },
    "featureName": "EksAuditLogs"
  },
  "severity": 7.8,
  "createdAt": "2024-01-06T16:45:00.000Z",
  "updatedAt": "2024-01-06T16:45:00.000Z",
  "title": "Execution:Kubernetes/ExecInKubeSystemPod",
  "description": "A user executed a command in a pod running in the kube-system namespace. The kube-system namespace contains critical Kubernetes system components, and unauthorized access could indicate a security compromise."
}